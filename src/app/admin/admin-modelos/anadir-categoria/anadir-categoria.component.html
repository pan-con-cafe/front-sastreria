<form #formCategoria="ngForm" (ngSubmit)="guardarCategoria()" novalidate>
  <div class="form-container">
    <div class="header">
      <h2 class="titulo">Añadir categoría:</h2>
    </div>
    

    <div class="form-group">
      <label for="nombre">Nombre:</label>
      <input
        id="nombre"
        name="nombre"
        class="input"
        type="text"
        placeholder="Inserte un nombre"
        [(ngModel)]="nombreCategoria"
        required
        minlength="3"
        #nombreRef="ngModel"
        (input)="onCambios()"
      />
      <div class="error" *ngIf="nombreRef.invalid && nombreRef.touched">
        <small *ngIf="nombreRef.errors?.['required']">El nombre es obligatorio.</small>
        <small *ngIf="nombreRef.errors?.['minlength']">Debe tener al menos 3 caracteres.</small>
      </div>
    </div>

    <div class="form-group">
      <label>Modelos seleccionados:</label>
      <div class="modelos-container">
        <div class="modelo" *ngFor="let modelo of modelosSeleccionados; let i = index">
          <button type="button" class="icono-eliminar" (click)="eliminarModelo(i)">
            <img src="/remove.png" alt="quitar" class="img-eliminar">
          </button>
          <div class="imagen-modelo" [style.background-image]="'url(' + modelo.imagen + ')'"></div>
        </div>
        <button type="button" class="btn-agregar" (click)="abrirModalSelector()">
          <img src="add.png" alt="añadir" class="img-add">
        </button>
      </div>
    </div>


    <div class="boton-container">
      <button type="button" class="btn-cancelar" (click)="cancelar()" [disabled]="loader.isLoading()">Cancelar</button>
      <button type="submit" class="boton-guardar" [disabled]="formCategoria.invalid || modelosSeleccionados.length === 0 || loader.isLoading()">Guardar</button>
    </div>

    <p class="mensaje-error" *ngIf="mensajeError">{{ mensajeError }}</p>
  </div>
</form>

<p class="mensaje-exito" *ngIf="mensajeExito">Cambios guardados correctamente.</p>

<app-confirmacion-salida
    *ngIf="mostrarModalCancelar"
    (confirmar)="confirmarSalida()"
    (cancelar)="cerrarModalCancelar()">
</app-confirmacion-salida>



<app-modal-selector-modelo 
    *ngIf="mostrarModalSelector"
    [modelosDisponibles]="listaDeModelos"
    (onSelect)="agregarModelos($event)"
    (onClose)="mostrarModalSelector = false">
</app-modal-selector-modelo>
